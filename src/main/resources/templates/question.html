<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" >
    <title>问题</title>
    <link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/4.1.0/css/bootstrap.min.css">
    <style type="text/css">
        body{
            background-color:#F6F6F6;
        }
    </style>
</head>
<body>
<!--<script src="/js/vue.main.js"></script>-->
<script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
<script src="https://cdn.bootcss.com/popper.js/1.12.5/umd/popper.min.js"></script>
<script src="https://cdn.bootcss.com/bootstrap/4.1.0/js/bootstrap.min.js"></script>
<script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
<script src="https://unpkg.com/wangeditor/release/wangEditor.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vue"></script>
<!--<textarea class="form-control" rows="3" name=textarea></textarea>-->

<nav class="navbar navbar-expand-sm bg-light navbar-light">
    <a class="navbar-brand" href="/" style="margin-left: 90px">Wen</a>
    <ul class="navbar-nav">


        <li class="nav-item" style="margin-right: 850px">
            <a class="nav-link" href="/editquestion">提问</a>
        </li>
        <form action="/query" class="form-inline my-2 my-lg-0">
            <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search" name="word">
            <button class="btn btn-primary my-2 my-sm-0" type="submit">Search</button>
        </form>
        <li class="nav-item">
            <p class="nav-link " th:if="${login}" th:text="${user_name}">用户名</p>
        </li>
        <li class="nav-item">
            <a class="nav-link " th:if="${login}" href="/out" >退出登陆</a>
        </li>
        <li class="nav-item">
            <a class="nav-link " th:if="!${login}" href="/login.html">登陆</a>
        </li>
        <li class="nav-item">
            <a class="nav-link"   th:if="!${login}"href="/register.html">注册</a>
        </li>
    </ul>
</nav>
<div class="container">

    <div class="card" style="margin-bottom: 10px; margin-top: 20px">
        <div class="card-body">
            <p class="card-text" ><img style="height: 40px ;" src="/image/1.png"><span th:text="${question.user.user_name}"></span></p>
            <p class="card-text" th:utext="${question.question_conent}">Some example text. Some example text.</p>
            <p  id="questionId" hidden="hidden" th:text="${question.question_id}" ></p>
        </div>
    </div>



</div>
<div class="container" >
    <div class="card" style="margin-bottom: 10px; margin-top: 20px">
        <div class="card-body">
                    <ul class="list-group list-group-flush" th:each="ans:${answers}">
                        <li class="list-group-item">
                            <p class="card-text" ><img style="height: 40px ;" src="/image/1.png"><span th:text="${ans.user.user_name}"></span></p>

                    <p class="card-text" th:utext="${ans.answer_content}">Some example text. Some example text.</p>
                    <!--<a href="/question/{qu.question_id}" class="card-link">Card link</a>-->
                                <a href="#" th:href="@{/remove/answer/{answerid}(answerid=${ans.answer_id})}" class="card-link">删除回答</a>

                        </li>
                    </ul>
        </div>
            </div>

    <div class="card"  style="margin-bottom: 10px; margin-top: 20px;height: auto">
        <div class="card-header">我的回答</div>
        <div id="editor">

        </div>
        <div class="card-footer"><button id="button"  class="btn btn-primary" style="float:right">提交</button></div>
    </div>
</div>
<script>
    var E = window.wangEditor;
    var editor = new E('#editor');
    editor.customConfig.menus = [
        'head',  // 标题
        'bold',  // 粗体
        'fontSize',  // 字号
        'fontName',  // 字体
        'italic',  // 斜体
        'underline',  // 下划线
        'strikeThrough',  // 删除线
        'foreColor',  // 文字颜色
        'backColor',  // 背景颜色
        'link',  // 插入链接
        'list',  // 列表
        'justify',  // 对齐方式
        'quote',  // 引用
        'emoticon',  // 表情
        'image',  // 插入图片
        'table',  // 表格
        //'video',  // 插入视频
        'code',  // 插入代码
        'undo',  // 撤销
        'redo'  // 重复
    ];
    editor.customConfig.uploadImgServer = '/uploadimg';
    editor.customConfig.uploadFileName = 'myFileName';
    //editor.customConfig.uploadImgParamsWithUrl = true
    editor.customConfig.debug =true;
    editor.create();

    document.getElementById('button').addEventListener('click', function ()  {
                var dataqid = $("p#questionId").text();
                var datacon = $("textarea#textarea1").val();

                $.ajax({
                    url: '/answerAdd',
                    type: 'POST', //GET
                    async: true,    //或false,是否异步
                    data: {
                        question_id: dataqid,
                        answer_content: editor.txt.html()
                    },
                    timeout: 5000,    //超时时间
                    dataType: 'json',    //返回的数据格式：json/xml/html/script/jsonp/text

                    success: function (data, textStatus, jqXHR) {
                        if (data == 1) {
                            window.alert("成功")
                            window.location.reload();
                        }
                        if (data == -1) {
                            window.alert("请先登陆")
                        }

                    },
                    error: function (xhr, textStatus) {
                        console.log('错误')
                        console.log(xhr)
                        console.log(textStatus)
                    },

                })
            })


</script>
</body>
</html>